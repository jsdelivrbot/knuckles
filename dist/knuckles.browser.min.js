!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Knuckles=e()}}(function(){return function e(t,n,r){function o(u,s){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!s&&c)return c(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return o(n?n:e)},a,a.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./mutable_record"),i=e("../node_modules/sonic/dist/observable"),u=function(e){function t(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];e.call(this),this.addSource=function(e){return t._sources.push(e),t},this._sources=n,this._subject=new i.Subject}return r(t,e),t.prototype.has=function(e){return this._sources.reduce(function(t,n){return t||n.has(e)},!1)},t.prototype.get=function(e){var t;for(var n in this._sources)if(t=this._sources[n].get(e))return t;return null},t.prototype.observe=function(e){return this._subject.observe(e)},t.prototype.set=function(e,t){this._sources.forEach(function(n){null!=n.set&&n.set(e,t)}),this._subject.notify(function(t){t.onInvalidate(e)})},t.prototype["delete"]=function(e){this._sources.forEach(function(t){null!=t["delete"]&&t["delete"](e)}),this._subject.notify(function(t){t.onInvalidate(e)})},t}(o.MutableRecord);n.Knuckle=u,n["default"]=u},{"../node_modules/sonic/dist/observable":11,"./mutable_record":2}],2:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./observable_record"),i=e("../node_modules/sonic/dist/mutable_list"),u=function(e){function t(t){e.call(this,t),null!=t&&(this.set=t.set,this["delete"]=t["delete"])}return r(t,e),t.prototype.set=function(e,t){throw new Error("Not implemented")},t.prototype["delete"]=function(e){throw new Error("Not implemented")},t.prototype.zoom=function(e){return i.MutableList.create(t.zoom(this,e))},t.prototype.compose=function(e){return t.create(t.compose(this,e))},t.create=function(e){return new t(e)},t.zoom=function(e,t){function n(n,r){n==t&&e.set(t,r)}function r(n,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];o.length?e.set(t,o[0]):e["delete"](t)}var i=o.ObservableRecord.zoom(e,t);return{has:i.has,get:i.get,prev:i.prev,next:i.next,observe:i.observe,set:n,splice:r}},t.compose=function(e,t){function n(n){return t.get(e.get(n))}function r(n,r){e.set(n,t.set(e.get(n),r))}return{has:e.has.bind(e),get:n,set:r,"delete":e["delete"].bind(e),observe:e.observe.bind(e)}},t}(o.ObservableRecord);n.MutableRecord=u,n["default"]=u},{"../node_modules/sonic/dist/mutable_list":10,"./observable_record":3}],3:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("../node_modules/sonic/dist/unit"),i=e("./record"),u=e("../node_modules/sonic/dist/observable_list"),s=function(e){function t(t){e.call(this,t),null!=t&&(this.observe=t.observe)}return r(t,e),t.prototype.observe=function(e){throw new Error("Not implemented")},t.prototype.zoom=function(e){return u.ObservableList.create(t.zoom(this,e))},t.create=function(e){return new t(e)},t.zoom=function(e,t){var n=new o["default"];return e.has(t)&&n.set(t,e.get(t)),e.observe({onInvalidate:function(t){e.has(t)?n.set(t,e.get(t)):n.splice(null,null)}}),{has:n.has,get:n.get,prev:n.prev,next:n.next,observe:n.observe}},t}(i.Record);n.ObservableRecord=s,n["default"]=s},{"../node_modules/sonic/dist/observable_list":13,"../node_modules/sonic/dist/unit":15,"./record":4}],4:[function(e,t,n){var r=e("../node_modules/sonic/dist/unit"),o=e("../node_modules/sonic/dist/list"),i=function(){function e(e){null!=e&&(this.get=e.get,this.has=e.has)}return e.prototype.has=function(e){throw new Error("Not implemented")},e.prototype.get=function(e){throw new Error("Not implemented")},e.prototype.zoom=function(t){return o.List.create(e.zoom(this,t))},e.create=function(t){return new e(t)},e.zoom=function(e,t){var n=new r["default"];return e.has(t)&&n.set(t,e.get(t)),{has:n.has,get:n.get,prev:n.prev,next:n.next}},e}();n.Record=i,n["default"]=i},{"../node_modules/sonic/dist/list":9,"../node_modules/sonic/dist/unit":15}],5:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./simple_record"),i=function(e){function t(t){this._urlRoot=t,e.call(this,{})}return r(t,e),t.prototype._fetch=function(e,t){var n,r=this._urlRoot+"/"+e,o={headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"};return 2==arguments.length&&(o.method=t?"PUT":"DELETE"),null!=t&&(o.body=JSON.stringify(t)),console.log(r,o),n=window.fetch(r,o),n.then(function(e){return e.json()})},t.prototype.get=function(t){var n,r=e.prototype.set.bind(this);return(n=e.prototype.get.call(this,t))?n:(this._fetch(t).then(function(e){r(t,e)}),null)},t.prototype.set=function(t,n){var r=e.prototype.set.bind(this);return this._fetch(t,n).then(function(){r(t,n)}),null},t.prototype["delete"]=function(e){this._fetch(e,null),this._subject.notify(function(t){t.onInvalidate(e)})},t}(o["default"]);n.RemoteRecord=i,n["default"]=i},{"./simple_record":6}],6:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./mutable_record"),i=e("../node_modules/sonic/dist/observable"),u=function(e){function t(t){e.call(this),this._object=t,this._subject=new i.Subject}return r(t,e),t.prototype.has=function(e){return e in this._object},t.prototype.get=function(e){return this._object[e]},t.prototype.observe=function(e){return this._subject.observe(e)},t.prototype.set=function(e,t){this._object[e]=t,this._subject.notify(function(t){t.onInvalidate(e)})},t.prototype["delete"]=function(e){e in this._object&&(delete this._object[e],this._subject.notify(function(t){t.onInvalidate(e)}))},t}(o.MutableRecord);n["default"]=u},{"../node_modules/sonic/dist/observable":11,"./mutable_record":2}],7:[function(e,t,n){var r=function(){function e(e){this._byKey=Object.create(null),this._next=Object.create(null),this._prev=Object.create(null),this._list=e}return e.prototype.has=function(e){return e in this._byKey||this._list.has(e)},e.prototype.get=function(e){return e in this._byKey?this._byKey[e]:this._list.has(e)?this._byKey[e]=this._list.get(e):void 0},e.prototype.prev=function(e){if(e in this._prev)return this._prev[e];var t=this._list.prev(e);return null==t&&(t=null),this._prev[e]=t,this._next[t]=e,t},e.prototype.next=function(e){if(void 0===e&&(e=null),e in this._next)return this._next[e];var t=this._list.next(e);return null==t&&(t=null),this._next[e]=t,this._prev[t]=e,t},e}();n["default"]=r},{}],8:[function(e,t,n){var r;!function(e){function t(e){return e.toString()}function n(){return r++}var r=0;e.key=t,e.create=n}(r||(r={})),n["default"]=r},{}],9:[function(e,t,n){var r=e("./tree"),o=e("./cache"),i=function(){function e(t){var n=this;this.has=function(e){throw new Error("Not implemented")},this.get=function(e){throw new Error("Not implemented")},this.prev=function(e){throw new Error("Not implemented")},this.next=function(e){throw new Error("Not implemented")},this.first=function(){return e.first(n)},this.last=function(){return e.last(n)},this.forEach=function(t){return e.forEach(n,t)},this.reduce=function(t,r){return e.reduce(n,t)},this.toArray=function(){return e.toArray(n)},this.findKey=function(t){return e.findKey(n,t)},this.find=function(t){return e.find(n,t)},this.keyOf=function(t){return e.keyOf(n,t)},this.indexOf=function(t){return e.indexOf(n,t)},this.keyAt=function(t){return e.keyAt(n,t)},this.at=function(t){return e.at(n,t)},this.every=function(t){return e.every(n,t)},this.some=function(t){return e.some(n,t)},this.contains=function(t){return e.contains(n,t)},this.reverse=function(){return e.create(e.reverse(n))},this.map=function(t){return e.create(e.map(n,t))},this.filter=function(t){return e.create(e.filter(n,t))},this.flatten=function(){return e.create(e.flatten(n))},this.flatMap=function(t){return e.create(e.flatMap(n,t))},this.cache=function(){return e.create(e.cache(n))},null!=t&&(this.has=t.has,this.get=t.get,this.prev=t.prev,this.next=t.next)}return e.isList=function(e){return!!(null!=e&&e.has&&e.get&&e.prev&&e.next)},e.create=function(t){return new e({has:t.has,get:t.get,prev:t.prev,next:t.next})},e.first=function(e){return e.get(e.next())},e.last=function(e){return e.get(e.prev())},e.forEach=function(e,t){for(var n;null!=(n=e.next(n));)t(e.get(n),n)},e.reduce=function(e,t,n){for(var r;null!=(r=e.next(r));)n=t(n,e.get(r),r);return n},e.toArray=function(t){return e.reduce(t,function(e,t){return e.push(t),e},[])},e.findKey=function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return n},e.find=function(t,n){return t.get(e.findKey(t,n))},e.keyOf=function(t,n){return e.findKey(t,function(e){return e===n})},e.indexOf=function(e,t){for(var n,r=0;null!=(n=e.next(n));){if(e.get(n)===t)return r;r++}},e.keyAt=function(e,t){for(var n,r=0;null!=(n=e.next(n));)if(r++==t)return n;return null},e.at=function(t,n){return t.get(e.keyAt(t,n))},e.every=function(e,t){for(var n;null!=(n=e.next(n));)if(!t(e.get(n),n))return!1;return!0},e.some=function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return!0;return!1},e.contains=function(t,n){return e.some(t,function(e){return e===n})},e.reverse=function(e){function t(t){return e.next(t)}function n(t){return e.prev(t)}var r=e.has,o=e.get;return{has:r,get:o,prev:t,next:n}},e.map=function(e,t){function n(n){return r(n)?t(e.get(n),n):void 0}var r=e.has,o=e.prev,i=e.next;return{has:r,get:n,prev:o,next:i}},e.filter=function(e,t){function n(n){return e.has(n)&&t(e.get(n),n)}function r(t){return n(t)?e.get(t):void 0}function o(t){for(var r=t;null!=(r=e.prev(r));)if(n(r))return r;return null}function i(t){for(var r=t;null!=(r=e.next(r));)if(n(r))return r;return null}return{has:n,get:r,prev:o,next:i}},e.flatten=function(e){function t(t){var n=r.Path.create(t);return r.Tree.has(e,n,1)}function n(t){var n=r.Path.create(t);return r.Tree.get(e,n,1)}function o(t){var n=r.Path.create(t);return r.Path.key(r.Tree.prev(e,n,1))}function i(t){var n=r.Path.create(t);return r.Path.key(r.Tree.next(e,n,1))}return{has:t,get:n,prev:o,next:i}},e.flatMap=function(t,n){return e.flatten(e.map(t,n))},e.cache=function(e){return new o["default"](e)},e}();n.List=i,n["default"]=i},{"./cache":7,"./tree":14}],10:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./observable_list"),i=function(e){function t(n){var r=this;e.call(this,n),this.set=function(e,t){throw new Error("Not implemented")},this.splice=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];throw new Error("Not implemented")},this.addBefore=function(e,n){return t.addBefore(r,e,n)},this.addAfter=function(e,n){return t.addAfter(r,e,n)},this.push=function(e){return t.push(r,e)},this.unshift=function(e){return t.unshift(r,e)},this["delete"]=function(e){return t["delete"](r,e)},this.deleteBefore=function(e){return t.deleteBefore(r,e)},this.deleteAfter=function(e){return t.deleteAfter(r,e)},this.pop=function(){return t.pop(r)},this.shift=function(){return t.shift(r)},this.remove=function(e){return t.remove(r,e)},null!=n&&(this.set=n.set,this.splice=n.splice)}return r(t,e),t.isMutableList=function(e){return o.ObservableList.isObservableList(e)&&!!e.set&&!!e.splice},t.create=function(e){return new t({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe,set:e.set,splice:e.splice})},t.addBefore=function(e,t,n){return e.splice(e.prev(t),t,n),e.prev(t)},t.addAfter=function(e,t,n){return e.splice(t,e.next(t),n),e.next(t)},t.push=function(e,n){return t.addBefore(e,null,n)},t.unshift=function(e,n){return t.addAfter(e,null,n)},t["delete"]=function(e,t){if(e.has(t)){var n=e.get(t);return e.splice(e.prev(t),e.next(t)),n}},t.deleteBefore=function(e,n){return t["delete"](e,e.prev(n))},t.deleteAfter=function(e,n){return t["delete"](e,e.next(n))},t.pop=function(e){return t.deleteBefore(e,null)},t.shift=function(e){return t.deleteAfter(e,null)},t.remove=function(e,n){var r=t.keyOf(e,n);return null==r?!1:(delete r,!0)},t}(o.ObservableList);n.MutableList=i,n["default"]=i},{"./observable_list":13}],11:[function(e,t,n){var r=e("./key"),o=function(){function e(){var e=this;this.observe=function(t){var n=r["default"].create();return e._observers[n]=t,{unsubscribe:function(){delete e._observers[n]}}},this.notify=function(t){for(var n in e._observers)t(e._observers[n])},this._observers=Object.create(null)}return e}();n.Subject=o},{"./key":8}],12:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./cache"),i=function(e){function t(t){var n=this;e.call(this,t),t.observe({onInvalidate:function(e,t){var r;for(r=e;void 0!==(r=n._next[r])&&(delete n._next[n._prev[r]],delete n._prev[r],r!=t);)delete n._byKey[r];for(;void 0!==(r=n._prev[r])&&(delete n._prev[n._next[r]],delete n._next[r],r!=e);)delete n._byKey[r]}})}return r(t,e),t.prototype.observe=function(e){return this._list.observe(e)},t}(o["default"]);n["default"]=i},{"./cache":7}],13:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./list"),i=e("./tree"),u=e("./observable"),s=e("./observable_cache"),c=function(e){function t(n){var r=this;e.call(this,n),this.observe=function(e){throw new Error("Not implemented")},this.reverse=function(){return t.create(t.reverse(r))},this.map=function(e){return t.create(t.map(r,e))},this.filter=function(e){return t.create(t.filter(r,e))},this.flatten=function(){return t.create(t.flatten(r))},this.flatMap=function(e){return t.create(t.flatMap(r,e))},this.cache=function(){return t.create(t.cache(r))},null!=n&&(this.observe=n.observe)}return r(t,e),t.isObservableList=function(e){return o.List.isList(e)&&!!e.observe},t.create=function(e){return new t({has:e.has.bind(e),get:e.get.bind(e),prev:e.prev.bind(e),next:e.next.bind(e),observe:e.observe.bind(e)})},t.reverse=function(e){function t(t){return e.observe(t)}var n=o.List.reverse(e),r=n.has,i=n.get,u=n.prev,s=n.next;return{has:r,get:i,prev:u,next:s,observe:t}},t.map=function(e,t){var n=o.List.map(e,t),r=n.has,i=n.get,u=n.prev,s=n.next;return{has:r,get:i,prev:u,next:s,observe:e.observe}},t.filter=function(e,t){function n(t){return e.observe({onInvalidate:function(e,n){e=i(e)?e:s(e),n=i(n)?n:c(n),t.onInvalidate(e,n)}})}var r=o.List.filter(e,t),i=r.has,u=r.get,s=r.prev,c=r.next;return{has:i,get:u,prev:s,next:c,observe:n}},t.flatten=function(e){var n,r=Object.create(null),s=new u.Subject;e.observe({onInvalidate:function(e,t){var o;for(o=e;null!=(o=n.next(o))&&o!=t;){var i=r[o];i&&(i.unsubscribe(),delete r[o])}for(o=t;null!=(o=n.prev(o))&&o!=e;){var i=r[o];i&&(i.unsubscribe(),delete r[o])}}}),n=t.cache(t.map(e,function(t,n){return r[n]=t.observe({onInvalidate:function(t,r){var o,u,c=i.Path.append(n,t),f=i.Path.append(n,r);null==t&&(c=i.Tree.prev(e,i.Tree.next(e,c))),null==r&&(f=i.Tree.next(e,i.Tree.prev(e,f))),o=i.Path.key(c),u=i.Path.key(f),s.notify(function(e){e.onInvalidate(o,u)})}}),t})),n.observe({onInvalidate:function(t,n){var r=i.Path.key(i.Tree.prev(e,[t])),o=i.Path.key(i.Tree.next(e,[n]));s.notify(function(e){e.onInvalidate(r,o)})}});var c=o.List.flatten(n),f=c.has,a=c.get,l=c.next,h=c.prev;return{has:f,get:a,next:l,prev:h,observe:s.observe}},t.flatMap=function(e,n){return t.flatten(t.map(e,n))},t.cache=function(e){return new s["default"](e)},t}(o.List);n.ObservableList=c,n["default"]=c},{"./list":9,"./observable":11,"./observable_cache":12,"./tree":14}],14:[function(e,t,n){var r,o=e("./list");!function(e){function t(e){return JSON.stringify(e)}function n(e){return null==e?null:JSON.parse(e.toString())}function r(e){return e?e[0]:null}function o(e,t){return e[t]}function i(e){return null==e?[]:e.slice(1,e.length)}function u(e,t){return[].concat(e).concat(t)}e.key=t,e.create=n,e.head=r,e.get=o,e.tail=i,e.append=u}(r=n.Path||(n.Path={}));var i;!function(e){function t(t,n,o){void 0===o&&(o=1/0);var i=r.head(n),u=r.tail(n);return t.has(i)&&(0==u.length||0==o||e.has(t.get(i),u,o))}function n(t,n,o){void 0===o&&(o=1/0);var i=r.head(n),u=r.tail(n);if(t.has(i)){var s=t.get(i);return 0==u.length||0==o?s:e.get(s,u,o)}}function i(t,n,i){void 0===n&&(n=[]),void 0===i&&(i=1/0);var u,s=r.head(n),c=r.tail(n),f=s;if(null==s||t.has(s))do if(u=t.get(f),o.List.isList(u)&&0!=i){var a=e.prev(u,c,i-1);if(null!=a)return r.append(f,a);c=[]}else if(null!=f&&f!=s)return[f];while(null!=(f=t.prev(f)))}function u(t,n,i){void 0===n&&(n=[]),void 0===i&&(i=1/0);var u,s=r.head(n),c=r.tail(n),f=s;if(null==s||t.has(s))do if(u=t.get(f),o.List.isList(u)&&0!=i){var a=e.next(u,c,i-1);if(null!=a)return r.append(f,a);c=[]}else if(null!=f&&f!=s)return[f];while(null!=(f=t.next(f)))}e.has=t,e.get=n,e.prev=i,e.next=u}(i=n.Tree||(n.Tree={})),n["default"]=i},{"./list":9}],15:[function(e,t,n){var r=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},o=e("./key"),i=e("./observable"),u=e("./mutable_list"),s=function(e){function t(t){var n=this;e.call(this),this.has=function(e){return n._key==e},this.get=function(e){return n.has(e)?n._value:void 0},this.prev=function(e){return null==e?n._key:null},this.next=function(e){return null==e?n._key:null},this.set=function(e,t){n._key=e,n._value=t,n._invalidate()},this.splice=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return r.length?n.set(o["default"].create(),r[0]):(delete n._key,delete n._value,void n._invalidate())},this.observe=function(e){return n._subject.observe(e)},this._invalidate=function(e,t){n._subject.notify(function(n){n.onInvalidate(e,t)})},this._subject=new i.Subject,arguments.length&&this.splice(null,null,t)}return r(t,e),t}(u.MutableList);n["default"]=s},{"./key":8,"./mutable_list":10,"./observable":11}],16:[function(e,t,n){function r(e,t){}var r,o=e("./observable_record"),i=e("./mutable_record"),u=e("./simple_record"),s=e("./knuckle"),c=e("./remote_record");!function(e){e.Record=u["default"],e.ObservableRecord=o["default"],e.MutableRecord=i["default"],e.SimpleRecord=u["default"],e.Knuckle=s["default"],e.RemoteRecord=c["default"],e.records={localStorage:new e.SimpleRecord(localStorage).compose({get:function(e){return JSON.parse(e)},set:function(e,t){return JSON.stringify(t)}})}}(r||(r={})),t.exports=r},{"./knuckle":1,"./mutable_record":2,"./observable_record":3,"./remote_record":5,"./simple_record":6}]},{},[16])(16)});