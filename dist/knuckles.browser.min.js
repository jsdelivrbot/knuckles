!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Knuckles=e()}}(function(){return function e(t,n,r){function u(i,a){if(!n[i]){if(!t[i]){var f="function"==typeof require&&require;if(!a&&f)return f(i,!0);if(o)return o(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return u(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)u(r[i]);return u}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("../node_modules/sonic/dist/sonic"),i=r(o),a=e("./xhr"),f=r(a),s=e("./resource"),c=r(s);!function(e){e.Sonic=i["default"],e.XHR=f["default"],e.Resource=c["default"]}(u||(u={})),t.exports=u,n["default"]=u,t.exports=n["default"]},{"../node_modules/sonic/dist/sonic":14,"./resource":2,"./xhr":3}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=function(){function e(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(f){u=!0,o=f}finally{try{!r&&a["return"]&&a["return"]()}finally{if(u)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("sonic/dist/state"),a=r(i),f=e("sonic/dist/cache"),s=r(f),c=e("sonic/dist/async_iterator"),l=r(c),d=e("sonic/dist/list"),v=e("sonic/dist/observable"),p=e("sonic/dist/promise_utils"),h=r(p),m=e("./xhr"),g=r(m);n.Resource=u,function(e){function t(e){return l["default"].forEach(a["default"].entries(e),function(){})}function n(e){var n,u=arguments.length<=1||void 0===arguments[1]?"id":arguments[1],i=v.Subject.create(),f=v.Observable.map(i,function(r){return l["default"].forEach(a["default"].entries(n.state,r.range),function(t){var n=o(t,2),r=n[0];n[1];g["default"].del(e+"/"+r)}).then(function(){if(null==r.added)return Promise.resolve(r);var n=a["default"].map(r.added,function(t){var n=t[u],r=JSON.stringify(t);return(null!=n?g["default"].put(e+"/"+n,r):g["default"].post(e,r)).then(JSON.parse)}),o=a["default"].cache(n),i=a["default"].keyBy(o,function(e){return e[u]});return t(i).then(function(){return{range:r.range,added:i}})})});return n=d.List.create(r(e,u),{onNext:i.onNext,subscribe:f.subscribe})}function r(e){function t(t){return g["default"].get(e+"/"+t).then(JSON.parse)}function n(e){return i.then(function(t){return t.prev(e)})}function r(e){return i.then(function(t){return t.next(e)})}var u=arguments.length<=1||void 0===arguments[1]?"id":arguments[1],o=s["default"].create(),i=h["default"].lazy(function(t){var n=g["default"].get(e).then(JSON.parse).then(a["default"].fromArray).then(function(e){return a["default"].keyBy(e,function(e){return o.get[e[u]]=Promise.resolve(e),e[u]})});t(n)});return s["default"].apply({get:t,prev:n,next:r},o)}e.create=n,e.createState=r}(u||(n.Resource=u={})),n["default"]=u},{"./xhr":3,"sonic/dist/async_iterator":4,"sonic/dist/cache":5,"sonic/dist/list":9,"sonic/dist/observable":10,"sonic/dist/promise_utils":12,"sonic/dist/state":15}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;n.XHR=r,function(e){function t(e,t){return new Promise(function(n,r){var u=new XMLHttpRequest,o=t.method,i=t.body;u.onload=function(){return u.status>=200&&u.status<400?n(u):r(u)},u.onerror=u.onabort=u.ontimeout=function(){return r(u)},u.open(o,e,!0),u.setRequestHeader("Content-Type","application/json"),u.send(i)})}function n(e){return t(e,{method:"get"}).then(function(e){return e.responseText})}function r(e,n){return t(e,{method:"put",body:n}).then(function(e){return e.responseText})}function u(e,n){return t(e,{method:"post",body:n}).then(function(e){return e.responseText})}function o(e){return t(e,{method:"delete"}).then(function(e){return e.responseText})}e.fetch=t,e.get=n,e.put=r,e.post=u,e.del=o}(r||(n.XHR=r={})),n["default"]=r},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=function(){function e(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(f){u=!0,o=f}finally{try{!r&&a["return"]&&a["return"]()}finally{if(u)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("./key"),a=r(i);n.AsyncIterator=u,function(e){function t(e,t){function n(){return e.next().then(function(e){return e.done?!0:Promise.resolve(t(e.value)).then(function(e){return e?n():!1})})}return n()}function n(e,n){return t(e,function(e){return Promise.resolve(n(e)).then(function(e){return!e})}).then(function(e){return!e})}function r(e,n){return t(e,function(e){return Promise.resolve(n(e)).then(function(){return!0})}).then(function(){})}function u(e,t,n){return r(e,function(e){return Promise.resolve(t(n,e)).then(function(e){n=e})}).then(function(){return n})}function i(e,t){var r;return n(e,function(e){return Promise.resolve(t(e)).then(function(t){return t?(r=e,!0):!1})}).then(function(e){return e?r:a["default"].NOT_FOUND})}function f(e,t){var r=-1;return n(e,function(e){return r++,t==e}).then(function(e){return e?r:a["default"].NOT_FOUND})}function s(e,t){return i(e,function(){return 0===t--})}function c(e,t){return n(e,function(e){return e===t})}function l(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return n.reduce(function(e,t){var n=!1,r=Promise.resolve(null);return{next:function(){return r=r.then(function(){},function(){}).then(function(){return n?t.next():e.next().then(function(e){return e.done?(n=!0,t.next()):e})})}}},e.Empty)}function d(t,n){var r=arguments.length<=2||void 0===arguments[2]?function(e,t){return e===t}:arguments[2];return e.every(t,function(e){return n.next().then(function(t){return!t.done&&r(t.value,e)})}).then(function(e){return e?n.next().then(function(e){return e.done}):!1})}function v(t){var n=-1,r=Promise.resolve(null);return{next:function(){return r=r.then(function(){},function(){}).then(function(){return Promise.resolve(++n>=t.length?e.sentinel:{done:!1,value:t[n]})})}}}function p(e){return v(Object.keys(e).map(function(t){return[t,e[t]]}))}function h(e){return u(e,function(e,t){return e.push(t),e},[])}function m(e){return u(e,function(e,t){var n=o(t,2),r=n[0],u=n[1];return e[r]=u,e},Object.create(null))}e.sentinel={done:!0},e.Empty={next:function(){return Promise.resolve(e.sentinel)}},e.every=t,e.some=n,e.forEach=r,e.reduce=u,e.find=i,e.indexOf=f,e.at=s,e.contains=c,e.concat=l,e.is=d,e.fromArray=v,e.fromObject=p,e.toArray=h,e.toObject=m}(u||(n.AsyncIterator=u={})),n["default"]=u},{"./key":7}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./key"),i=r(o);n.Cache=u,function(e){function t(){return{get:Object.create(null),prev:Object.create(null),next:Object.create(null)}}function n(e){return{get:Object.create(e.get),prev:Object.create(e.prev),next:Object.create(e.next)}}function r(e,t){function n(n){return n in t.get?t.get[n]:t.get[n]=e.get(n)}function r(){var n=arguments.length<=0||void 0===arguments[0]?i["default"].sentinel:arguments[0];return n in t.prev?t.prev[n]:t.prev[n]=e.prev(n).then(function(e){return t.next[e]=Promise.resolve(n),e})}function u(){var n=arguments.length<=0||void 0===arguments[0]?i["default"].sentinel:arguments[0];return n in t.next?t.next[n]:t.next[n]=e.next(n).then(function(e){return t.prev[e]=Promise.resolve(n),e})}return{get:n,prev:r,next:u}}e.create=t,e.extend=n,e.apply=r}(u||(n.Cache=u={})),n["default"]=u},{"./key":7}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;n.Entry=r,function(e){function t(e){return e&&e[0]}function n(e){return e[1]}function r(e,t){return e[0]===t[0]&&e[1]===t[1]}e.key=t,e.value=n,e.is=r}(r||(n.Entry=r={})),n["default"]=r},{}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./promise_utils"),i=r(o);!function(e){function t(e){return e.toString()}function n(){return r++}e.NOT_FOUND_ERROR=new Error("No entry at the specified key"),e.NOT_FOUND=i["default"].lazy(function(t,n){return n(e.NOT_FOUND_ERROR)}),e.sentinel=null;var r=0;e.key=t,e.create=n}(u||(u={})),n["default"]=u,t.exports=n["default"]},{"./promise_utils":12}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./state"),i=r(o),a=e("./list"),f=e("./observable");n.Lens=u,function(e){function t(e,t){var n=f.Subject.create(),r=f.Subject.create();return f.Observable.map(e.patches,function(e){return e.added?{range:e.range,added:i["default"].map(e.added,t.get)}:{range:e.range}}).subscribe(n),f.Observable.map(r,function(e){return e.added?{range:e.range,added:i["default"].map(e.added,t.set)}:{range:e.range}}).subscribe(e.patches),a.List.create(i["default"].map(e.state,t.get),{subscribe:n.subscribe,onNext:r.onNext})}e.compose=t}(u||(n.Lens=u={})),n["default"]=u},{"./list":9,"./observable":10,"./state":15}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./key"),i=r(o),a=e("./patch"),f=r(a),s=e("./state"),c=r(s),l=e("./range"),d=e("./tree"),v=e("./observable"),p=e("./async_iterator"),h=r(p);n.List=u,function(e){function t(e,t){var n=c["default"].map(e.state,t),r=v.Observable.map(e.patches,function(e){return{range:e.range,added:e.added?c["default"].map(e.added,t):void 0}});return a(n,r)}function n(e,t){var n=c["default"].filter(e.state,t),r=v.Observable.map(e.patches,function(e){return Promise.all([h["default"].findKey(c["default"].toIterator(c["default"].reverse(n),[l.Position.reverse(e.range[0]),{prev:null}]),t).then(function(e){return{next:e}}),h["default"].findKey(c["default"].toIterator(n,[e.range[1],{prev:null}]),t).then(function(e){return{prev:e}})]).then(function(n){return{range:n,added:e.added?c["default"].filter(e.added,t):void 0}})});return a(n,r,function(e,t){return n=f["default"].apply(e,t)})}function r(e,t){var n=e.state,r=c["default"].zoom(e.state,t),u=v.Observable.map(v.Observable.filter(e.patches,function(e){return h["default"].some(c["default"].toIterator(n,e.range),function(e,n){return n===t}).then(function(n){return e.added?c["default"].has(e.added,t):n})}),function(r){return n=e.state,{range:l.Range.all,added:r.added?c["default"].zoom(r.added,t):void 0}});return a(r,u)}function u(e){var n=v.Subject.create(),r=o(t(e,function(e,t){return v.Observable.map(e.patches,function(n){function r(n){return n.prev===i["default"].sentinel?e.state.prev(i["default"].sentinel).then(function(e){return{next:d.Path.toKey([t,e])}}):Promise.resolve({prev:d.Path.toKey([t,n.prev])})}function u(n){return n.next===i["default"].sentinel?e.state.next(i["default"].sentinel).then(function(e){return{prev:d.Path.toKey([t,e])}}):Promise.resolve({next:d.Path.toKey([t,n.next])})}var o=n.range[0],a=n.range[1];return Promise.all([l.Position.isNextPosition(o)?u(o):r(o),l.Position.isNextPosition(a)?u(a):r(a)]).then(function(e){return{range:e,added:n.added?n.added:void 0}})}).subscribe(n),e.state}));v.Observable.map(e.patches,function(e){function t(e){return e.prev===i["default"].sentinel?Promise.resolve({prev:i["default"].sentinel}):d.Tree.next(r.state,[e.prev]).then(d.Path.toKey).then(function(e){return{prev:e}})}function n(e){return e.next===i["default"].sentinel?Promise.resolve({next:i["default"].sentinel}):d.Tree.prev(r.state,[e.next]).then(d.Path.toKey).then(function(e){return{next:e}})}var u=e.range[0],o=e.range[1];return Promise.all([l.Position.isNextPosition(u)?n(u):t(u),l.Position.isNextPosition(o)?n(o):t(o)]).then(function(t){return{range:t,added:e.added?c["default"].flatten(c["default"].map(e.added,function(e){return e.state})):void 0}})}).subscribe(n);var u=c["default"].flatten(r.state);return a(u,n)}function o(t){var n=c["default"].cache(t.state),r=v.Observable.map(t.patches,function(e){return{range:e.range,added:c["default"].cache(e.added)}});return e.create(n,r)}function a(e,t){var n=arguments.length<=2||void 0===arguments[2]?f["default"].apply:arguments[2],r={state:e,patches:t};return v.Observable.scan(t,n,e).subscribe({onNext:function(e){r.state=e}}),r}e.map=t,e.filter=n,e.zoom=r,e.flatten=u,e.cache=o,e.create=a}(u||(n.List=u={})),n["default"]=u},{"./async_iterator":4,"./key":7,"./observable":10,"./patch":11,"./range":13,"./state":15,"./tree":16}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./key"),i=r(o);n.Disposable=u,function(e){function t(e){var t=!1;return{dispose:function(){t||(t=!0,e())}}}e.create=t}(u||(n.Disposable=u={}));var a;n.Observable=a,function(e){function t(e,t){var n=f.create();return e.subscribe({onNext:function(e){return Promise.resolve(t(e)).then(n.onNext)}}),{subscribe:n.subscribe}}function n(e,t){var n=f.create();return e.subscribe({onNext:function(e){return Promise.resolve(t(e)).then(function(t){return t?n.onNext(e):void 0})}}),{subscribe:n.subscribe}}function r(e,t,n){var r=f.create();return e.subscribe({onNext:function(e){return Promise.resolve(t(n,e)).then(function(e){n=e,r.onNext(e)})}}),{subscribe:r.subscribe}}e.map=t,e.filter=n,e.scan=r}(a||(n.Observable=a={}));var f;n.Subject=f,function(e){function t(){function e(e){var t=i["default"].create();return n[t]=e,u.create(function(){return delete n[t]})}function t(e){return r=r.then(function(){return Promise.all(Object.keys(n).map(function(t){return n[t].onNext(e)})).then(function(){})})}var n=Object.create(null),r=Promise.resolve();return{subscribe:e,onNext:t}}e.create=t}(f||(n.Subject=f={}))},{"./key":7}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./state"),i=r(o);n.Patch=u,function(e){function t(e,t){return i["default"].splice(e,t.range,t.added)}e.apply=t}(u||(n.Patch=u={})),n["default"]=u},{"./state":15}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;n.PromiseUtils=r,function(e){function t(e){function t(t,r){return n?n.then(t,r):(n=new Promise(e)).then(t,r)}var n;return Promise.resolve({then:t})}e.lazy=t}(r||(n.PromiseUtils=r={})),n["default"]=r},{}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./key"),i=r(o);n.Range=u,function(e){e.all=[{next:i["default"].sentinel},{prev:i["default"].sentinel}]}(u||(n.Range=u={}));var a;n.Position=a,function(e){function t(e){return"prev"in e}function n(e){return"next"in e}function r(t){return e.isPrevPosition(t)?{next:t.prev}:{prev:t.next}}e.isPrevPosition=t,e.isNextPosition=n,e.reverse=r}(a||(n.Position=a={})),n["default"]=u},{"./key":7}],14:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return e instanceof Array?s.List.create(i["default"].fromArray(e),p.Subject.create()):e instanceof Object?s.List.create(i["default"].fromObject(e),p.Subject.create()):void 0}Object.defineProperty(n,"__esModule",{value:!0}),n.Sonic=u;var u,o=e("./state"),i=r(o),a=e("./async_iterator"),f=r(a),s=e("./list"),c=e("./tree"),l=r(c),d=e("./cache"),v=r(d),p=e("./observable"),h=e("./promise_utils"),m=r(h),g=e("./lens"),b=r(g);n.Sonic=u,function(e){e.State=i["default"],e.AsyncIterator=f["default"],e.List=s.List,e.Tree=l["default"],e.Subject=p.Subject,e.Cache=v["default"],e.PromiseUtils=m["default"],e.Lens=b["default"]}(u||(n.Sonic=n.Sonic=u={})),t.exports=u,n["default"]=u},{"./async_iterator":4,"./cache":5,"./lens":8,"./list":9,"./observable":10,"./promise_utils":12,"./state":15,"./tree":16}],15:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=function(){function e(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(f){u=!0,o=f}finally{try{!r&&a["return"]&&a["return"]()}finally{if(u)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("./key"),a=r(i),f=e("./entry"),s=r(f),c=e("./range"),l=e("./cache"),d=r(l),v=e("./async_iterator"),p=r(v),h=e("./tree");n.State=u,function(e){function t(e,t){var n=t.get,r=t.prev,u=t.next,o=Object.create(e);return n&&(o.get=n),r&&(o.prev=r),u&&(o.next=u),o}function n(e){return e.next().then(function(t){return e.get(t)})}function r(e){return e.prev().then(function(t){return e.get(t)})}function u(e,t){return e.get(t).then(function(){return!0},function(e){return e===a["default"].NOT_FOUND_ERROR?!1:Promise.reject(e)})}function i(e,t){var n=M(e),r=M(t);return p["default"].is(n,r,s["default"].is)}function f(e,t){return p["default"].some(M(e),function(e){var n=o(e,2),r=(n[0],n[1]);return r===t})}function l(e){return e.next().then(function(e){return e===a["default"].sentinel})}function v(e){var t=arguments.length<=1||void 0===arguments[1]?c.Range.all:arguments[1];return S(M(e,t))}function m(e,n,r){function o(e){return u(r,e).then(function(t){return t?d.get(e):p.get(e)})}function i(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return c.Position.isPrevPosition(m)&&e===m.prev?d.prev(a["default"].sentinel):u(d,e).then(function(t){return t?d.prev(e):p.prev(e)})}function f(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return c.Position.isNextPosition(h)&&e===h.next?d.next(a["default"].sentinel):u(d,e).then(function(t){return t?d.next(e):p.next(e)})}var s=v(e,n),l=y(e,function(e,t){return s.get(t).then(function(){return!1},function(){return!0})});if(null==r)return l;var d,p,h=n[0],m=n[1];return d=t(r,{prev:function(t){return r.prev(t).then(function(t){return t!==a["default"].sentinel?Promise.resolve(t):c.Position.isNextPosition(h)?Promise.resolve(h.next):e.prev(h.prev)})},next:function(t){return r.next(t).then(function(t){return t!==a["default"].sentinel?Promise.resolve(t):c.Position.isPrevPosition(m)?Promise.resolve(m.prev):e.next(m.next)})}}),p=t(l,{prev:function(t){return e.prev(t).then(function(e){return c.Position.isNextPosition(m)&&e===m.next?d.prev(a["default"].sentinel):u(s,e).then(function(t){return t?a["default"].NOT_FOUND:e})})},next:function(t){return e.next(t).then(function(e){return c.Position.isPrevPosition(h)&&e===h.prev?d.next(a["default"].sentinel):u(s,e).then(function(t){return t?a["default"].NOT_FOUND:e})})}}),{get:o,prev:i,next:f}}function g(e){return t(e,{prev:e.next,next:e.prev})}function b(e,n){return t(e,{get:function(t){return e.get(t).then(function(e){return n(e,t)})}})}function y(e,n){function r(t){return t in f?f[t]:f[t]=e.get(t).then(function(e){return n(e,t)})}function u(t){return r(t).then(function(n){return n?e.get(t):a["default"].NOT_FOUND})}function o(t){return e.prev(t).then(function(e){return null===e?null:r(e).then(function(t){return t?e:o(e)})})}function i(t){return e.next(t).then(function(e){return null===e?null:r(e).then(function(t){return t?e:i(e)})})}var f=Object.create(null);return t(e,{get:u,prev:o,next:i})}function x(e,n){var r=function(t){return null==t?e.get(n).then(function(){return n},function(e){return e===a["default"].NOT_FOUND_ERROR?null:Promise.reject(e)}):n===t?Promise.resolve(null):a["default"].NOT_FOUND};return t(e,{get:function(t){return t===n?e.get(n):a["default"].NOT_FOUND},prev:r,next:r})}function P(e){return t(e,{get:function(t){return h.Tree.get(e,h.Path.fromKey(t))},prev:function(t){return h.Tree.prev(e,h.Path.fromKey(t)).then(h.Path.toKey)},next:function(t){return h.Tree.next(e,h.Path.fromKey(t)).then(h.Path.toKey)}})}function O(e){return d["default"].apply(e,d["default"].create())}function _(n,r){var u=O(e.map(n,r)),i=O({get:function(e){return p["default"].find(M(u),function(t){var n=o(t,2),r=(n[0],n[1]);return r===e}).then(s["default"].key)},prev:function(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return Promise.resolve(e===a["default"].sentinel?a["default"].sentinel:i.get(e)).then(u.prev).then(function(e){return e===a["default"].sentinel?e:u.get(e)})},next:function(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return Promise.resolve(e===a["default"].sentinel?a["default"].sentinel:i.get(e)).then(u.next).then(function(e){return e===a["default"].sentinel?e:u.get(e)})}});return t(i,{get:function(e){return i.get(e).then(function(e){return e===a["default"].sentinel?a["default"].NOT_FOUND:n.get(e)})}})}function N(e){return b(e,function(e,t){return t})}function j(e){return S(p["default"].fromArray(e.map(function(e,t){return[t,e]})))}function T(e){return S(p["default"].fromObject(e))}function S(e){function t(e){return i?a["default"].NOT_FOUND:p["default"].find(c,function(t){var n=o(t,2),r=n[0];n[1];return r===e}).then(s["default"].value)}function n(e){return i?a["default"].NOT_FOUND:p["default"].some(c,function(t){var n=o(t,2),r=n[0];n[1];return r===e}).then(function(){return e in u.prev?u.prev[e]:a["default"].NOT_FOUND})}function r(e){return i?a["default"].NOT_FOUND:e===f?c.next().then(function(e){return e.done?a["default"].sentinel:e.value[0]}):p["default"].find(c,function(t){var n=o(t,2),r=n[0];n[1];return r===e}).then(function(){return c.next()}).then(function(e){return e.done?a["default"].sentinel:e.value[0]})}var u=d["default"].create(),i=!1,f=null,c=(Promise.resolve(null),{next:function(){return e.next().then(function(e){var t=e.done,n=e.value;return t?(i=!0,u.prev[a["default"].sentinel]=Promise.resolve(f),u.next[f]=Promise.resolve(a["default"].sentinel),p["default"].sentinel):(u.prev[n[0]]=Promise.resolve(f),u.next[f]=Promise.resolve(n[0]),u.get[n[0]]=Promise.resolve(n[1]),f=n[0],{done:t,value:n})})}});return d["default"].apply({get:t,prev:n,next:r},u)}function M(e){var t=arguments.length<=1||void 0===arguments[1]?c.Range.all:arguments[1],n=a["default"].sentinel,r=!1,u=t[0],o=t[1];return{next:function(){function t(t){return t===a["default"].sentinel?(r=!0,Promise.resolve(p["default"].sentinel)):e.get(t).then(function(e){return n=t,{done:!1,value:[t,e]}})}function i(n){return e.next(n).then(function(e){return t(c.Position.isPrevPosition(o)&&o.prev===e?a["default"].sentinel:e)})}return c.Position.isPrevPosition(u)&&c.Position.isPrevPosition(o)&&u.prev===o.prev?t(a["default"].sentinel):c.Position.isNextPosition(u)&&c.Position.isNextPosition(o)&&u.next===o.next?t(a["default"].sentinel):n===a["default"].sentinel?c.Position.isPrevPosition(u)?t(u.prev):i(u.next):c.Position.isNextPosition(o)&&o.next===n?t(a["default"].sentinel):i(n)}}}e.Empty={get:function(e){return a["default"].NOT_FOUND},prev:function(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return e==a["default"].sentinel?Promise.resolve(a["default"].sentinel):a["default"].NOT_FOUND},next:function(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return e==a["default"].sentinel?Promise.resolve(a["default"].sentinel):a["default"].NOT_FOUND}},e.extend=t,e.first=n,e.last=r,e.has=u,e.is=i,e.contains=f,e.isEmpty=l,e.slice=v,e.splice=m,e.reverse=g,e.map=b,e.filter=y,e.zoom=x,e.flatten=P,e.cache=O,e.keyBy=_,e.keys=N,e.fromArray=j,e.fromObject=T,e.fromEntries=S,e.entries=M}(u||(n.State=u={})),n["default"]=u},{"./async_iterator":4,"./cache":5,"./entry":6,"./key":7,"./range":13,"./tree":16}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u,o=e("./state"),i=r(o);n.Path=u,function(e){function t(e){return null==e?null:JSON.stringify(e)}function n(e){return null==e?null:JSON.parse(e.toString())}function r(e){return null==e?null:JSON.stringify(e)}function u(e){return e?e[0]:null}function o(e,t){return e?e[t]:null}function i(e){return null==e?[]:e.slice(1,e.length)}function a(e,t){return[].concat(e).concat(t)}e.key=t,e.fromKey=n,e.toKey=r,e.head=u,e.get=o,e.tail=i,e.append=a}(u||(n.Path=u={}));var a;n.Tree=a,function(e){function t(e,t){var n=u.get(t,0),r=u.get(t,1);return e.get(n).then(function(e){return e.get(r)})}function n(e,t){var n=u.get(t,0),r=u.get(t,1),o=i["default"].filter(i["default"].map(e,function(e){return e.prev()}),function(e){return null!=e}),a=i["default"].map(o,function(e,t){return[t,e]});return null==n?a.prev().then(function(e){return null!=e?a.get(e):null}):e.get(n).then(function(e){return e.prev(r)}).then(function(e){return null!=e?[n,e]:a.prev(n).then(function(e){return null!=e?a.get(e):null})})}function r(e,t){var n=u.get(t,0),r=u.get(t,1),o=i["default"].filter(i["default"].map(e,function(e){return e.next()}),function(e){return null!=e}),a=i["default"].map(o,function(e,t){return[t,e]});return null==n?a.next().then(function(e){return null!=e?a.get(e):null}):e.get(n).then(function(e){return e.next(r)}).then(function(e){return null!=e?[n,e]:a.next(n).then(function(e){return null!=e?a.get(e):null})})}e.get=t,e.prev=n,e.next=r}(a||(n.Tree=a={})),n["default"]=a},{"./state":15}]},{},[1])(1)});